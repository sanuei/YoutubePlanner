# YouTube Planner - 技术架构图

## 🏗️ 系统整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                        用户层                                │
├─────────────────────────────────────────────────────────────┤
│  Web浏览器 (Chrome/Firefox/Safari)                          │
│  ↓ HTTPS                                                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      网络层                                  │
├─────────────────────────────────────────────────────────────┤
│  域名: youtubeplanner.duckdns.org                           │
│  SSL证书: Let's Encrypt (自动续期)                          │
│  CDN: 无 (直接访问)                                         │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    AWS EC2 服务器                           │
│                  (t2.micro - 免费套餐)                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐    ┌─────────────────┐                │
│  │   Nginx 1.26    │    │  Docker Engine  │                │
│  │  (反向代理+SSL)  │    │                 │                │
│  │  Port: 80,443   │    │                 │                │
│  └─────────────────┘    └─────────────────┘                │
│           │                       │                        │
│           └───────────────────────┘                        │
│                       │                                    │
└───────────────────────┼────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────────┐
│                   Docker 容器层                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐ │
│  │  Frontend       │  │   Backend       │  │ PostgreSQL  │ │
│  │  (React App)    │  │ (Spring Boot)   │  │   Database  │ │
│  │                 │  │                 │  │             │ │
│  │  Port: 3000:80  │  │ Port: 8080:8080 │  │ Port: 5432  │ │
│  │  Nginx静态文件   │  │  REST API       │  │  数据存储    │ │
│  └─────────────────┘  └─────────────────┘  └─────────────┘ │
│           │                       │                │       │
│           └───────────────────────┼────────────────┘       │
│                                   │                        │
└───────────────────────────────────┼────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────┐
│                     数据层                                   │
├─────────────────────────────────────────────────────────────┤
│  PostgreSQL 15 数据库                                       │
│  ├── users (用户表 - 包含role字段)                          │
│  ├── channels (频道表)                                      │
│  ├── categories (分类表)                                    │
│  ├── scripts (脚本表)                                       │
│  ├── chapters (章节表)                                      │
│  └── mind_maps (思维导图表)                                 │
└─────────────────────────────────────────────────────────────┘
```

## 🔄 CI/CD 流水线架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   开发者本地     │    │   GitHub仓库     │    │  GitHub Actions │
│                │    │                │    │                │
│  ┌───────────┐  │    │  ┌───────────┐  │    │  ┌───────────┐  │
│  │ 代码编写   │  │    │  │ 代码推送   │  │    │  │ 自动构建   │  │
│  │ 本地测试   │  │    │  │ 版本控制   │  │    │  │ 自动测试   │  │
│  └───────────┘  │    │  └───────────┘  │    │  └───────────┘  │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────git push────────▶│                       │
                                 └──webhook触发──────────▶│
                                                          │
                                                          ▼
┌─────────────────────────────────────────────────────────────┐
│                    构建和部署流程                            │
├─────────────────────────────────────────────────────────────┤
│  1. 检出代码 (Checkout)                                     │
│  2. 设置环境 (Node.js 18 + Java 17)                        │
│  3. 构建前端 (npm ci && npm run build)                     │
│  4. 构建后端 (mvn clean package)                           │
│  5. 构建Docker镜像                                          │
│  6. 上传到EC2服务器                                         │
│  7. 部署容器 (docker-compose up -d)                        │
│  8. 健康检查                                                │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    生产环境                                  │
├─────────────────────────────────────────────────────────────┤
│  https://youtubeplanner.duckdns.org                        │
└─────────────────────────────────────────────────────────────┘
```

## 🔐 安全架构

```
┌─────────────────────────────────────────────────────────────┐
│                      安全防护层                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐ │
│  │   网络安全       │  │   应用安全       │  │  数据安全    │ │
│  │                │  │                │  │             │ │
│  │ • HTTPS加密     │  │ • JWT认证       │  │ • 数据加密   │ │
│  │ • SSL证书       │  │ • RBAC权限控制  │  │ • 备份策略   │ │
│  │ • 防火墙规则     │  │ • CORS限制      │  │ • 访问控制   │ │
│  │ • DDoS防护      │  │ • SQL注入防护   │  │ • 审计日志   │ │
│  │                │  │ • XSS防护       │  │ • 密码加密   │ │
│  │                │  │ • 管理员权限分离 │  │ • 敏感信息保护│ │
│  └─────────────────┘  └─────────────────┘  └─────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 📊 数据流架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   前端组件       │    │   API网关        │    │   业务逻辑层     │
│                │    │                │    │                │
│ ┌─────────────┐ │    │ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │ 用户界面     │ │    │ │ 路由分发     │ │    │ │ 业务服务     │ │
│ │ 管理员界面   │ │    │ │ 认证中间件   │ │    │ │ 权限验证     │ │
│ │ 状态管理     │ │    │ │ 权限检查     │ │    │ │ 数据验证     │ │
│ │ HTTP客户端   │ │    │ │ 错误处理     │ │    │ │ 业务规则     │ │
│ └─────────────┘ │    │ └─────────────┘ │    │ └─────────────┘ │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └──────HTTP请求─────────▶│                       │
                                 └──────API调用─────────▶│
                                                          │
                                                          ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   数据访问层     │    │   数据库层       │    │   缓存层         │
│                │    │                │    │                │
│ ┌─────────────┐ │    │ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │ JPA Repository│ │    │ │ PostgreSQL  │ │    │ │ 本地缓存     │ │
│ │ MyBatis      │ │    │ │ 数据表       │ │    │ │ (计划中)     │ │
│ │ 连接池       │ │    │ │ 索引优化     │ │    │ │ Redis       │ │
│ └─────────────┘ │    │ └─────────────┘ │    │ └─────────────┘ │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 🚀 技术栈详细说明

### 前端技术栈
```
React 18.2.0
├── TypeScript 4.9+          # 类型安全
├── React Router v6          # 路由管理
├── Axios                    # HTTP客户端
├── CSS3 + Flexbox          # 样式布局
├── Create React App        # 脚手架工具
├── React Flow              # 思维导图组件
└── Webpack                 # 模块打包
```

### 后端技术栈
```
Spring Boot 3.0
├── Spring Security         # 安全框架
├── Spring Data JPA         # 数据访问
├── MyBatis                 # SQL映射
├── PostgreSQL Driver       # 数据库驱动
├── JWT                     # 身份认证
├── Maven                   # 依赖管理
├── Spring Boot Actuator    # 监控端点
└── Flyway                  # 数据库迁移
```

### 运维技术栈
```
AWS EC2
├── Docker                  # 容器化
├── Docker Compose          # 容器编排
├── Nginx                   # 反向代理
├── Let's Encrypt          # SSL证书
├── GitHub Actions         # CI/CD
└── DuckDNS                # 域名服务
```

## 🎯 功能模块架构

### 用户管理模块
```
用户管理
├── 认证系统
│   ├── 用户注册/登录
│   ├── JWT Token管理
│   ├── 密码加密存储
│   └── 自动Token刷新
├── 权限系统
│   ├── RBAC角色控制
│   ├── 管理员权限
│   ├── 普通用户权限
│   └── 路由权限保护
└── 管理员功能
    ├── 用户列表管理
    ├── 用户信息编辑
    ├── 角色权限管理
    └── 用户状态控制
```

### 内容管理模块
```
内容管理
├── 思维导图
│   ├── 可视化编辑器
│   ├── 节点拖拽操作
│   ├── 自动布局算法
│   └── 历史版本管理
├── 脚本管理
│   ├── 多章节编辑
│   ├── 实时保存
│   ├── 状态跟踪
│   └── 高级筛选
├── 频道管理
│   ├── 多频道支持
│   ├── 频道信息管理
│   └── 脚本关联统计
└── 分类管理
    ├── 层级分类结构
    ├── 智能标签系统
    └── 分类统计分析
```

### AI集成模块
```
AI功能
├── 文案生成
│   ├── 多模式生成
│   ├── 流式输出
│   ├── 智能解析
│   └── API配置管理
├── 提示词管理
│   ├── 模板系统
│   ├── 参数化配置
│   └── 版本控制
└── API集成
    ├── OpenAI支持
    ├── Claude支持
    ├── 自定义API
    └── 使用量统计
```

## 📈 性能指标

### 响应时间
- **首页加载**: < 2秒
- **API响应**: < 500ms
- **数据库查询**: < 100ms
- **思维导图渲染**: < 1秒

### 并发能力
- **同时在线用户**: 100+
- **API QPS**: 1000+
- **数据库连接**: 10个连接池
- **WebSocket连接**: 50+

### 可用性
- **系统可用性**: 99.9%
- **SSL证书**: 自动续期
- **健康检查**: 30秒间隔
- **自动重启**: 容器故障恢复

## 🔄 数据同步架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   前端状态       │    │   后端API       │    │   数据库        │
│                │    │                │    │                │
│ ┌─────────────┐ │    │ ┌─────────────┐ │    │ ┌─────────────┐ │
│ │ React State │ │    │ │ Controller  │ │    │ │ PostgreSQL  │ │
│ │ Context API │ │◄───┤ │ Service     │ │◄───┤ │ Transactions│ │
│ │ Local Cache │ │    │ │ Repository  │ │    │ │ ACID        │ │
│ └─────────────┘ │    │ └─────────────┘ │    │ └─────────────┘ │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       │
         └──────实时同步──────────┼──────数据持久化──────▶│
                                 │                       │
                                 └──────事务管理──────────┘
```

## 🛡️ 安全控制流程

```
用户请求
    │
    ▼
┌─────────────────┐
│   前端验证       │ ← Token存储
│ • 路由保护      │ ← 权限检查
│ • 组件权限      │
└─────────────────┘
    │
    ▼
┌─────────────────┐
│   网络传输       │ ← HTTPS加密
│ • SSL/TLS      │ ← CORS限制
│ • 请求头验证    │
└─────────────────┘
    │
    ▼
┌─────────────────┐
│   后端验证       │ ← JWT解析
│ • Token验证     │ ← 权限注解
│ • 角色检查      │ ← 方法级保护
└─────────────────┘
    │
    ▼
┌─────────────────┐
│   数据访问       │ ← 参数化查询
│ • SQL注入防护   │ ← 数据验证
│ • 权限过滤      │ ← 审计日志
└─────────────────┘
```

---

## 💡 面试要点

### 架构设计亮点
1. **微服务思想**: 前后端分离，职责清晰
2. **容器化部署**: Docker提供环境一致性
3. **自动化运维**: CI/CD全流程自动化
4. **安全设计**: 多层安全防护
5. **权限管理**: RBAC角色控制系统
6. **AI集成**: 智能化内容创作

### 技术选型理由
1. **React + TypeScript**: 类型安全，开发效率高
2. **Spring Boot**: 生态成熟，开发快速
3. **PostgreSQL**: 性能优秀，支持复杂查询
4. **Docker**: 部署简单，环境隔离
5. **JWT**: 无状态认证，易于扩展
6. **React Flow**: 专业图形编辑组件

### 扩展性考虑
1. **水平扩展**: 支持多实例部署
2. **缓存策略**: 预留Redis缓存接口
3. **数据库优化**: 索引优化，分页查询
4. **监控告警**: Spring Boot Actuator
5. **微服务拆分**: 模块化设计便于拆分
6. **API版本管理**: 支持向后兼容

### 最新功能特性
1. **管理员系统**: 完整的用户管理功能
2. **思维导图**: 可视化创作工具
3. **AI文案生成**: 智能内容创作
4. **权限分离**: 管理员与普通用户权限隔离
5. **实时协作**: 支持多用户同时操作
6. **数据安全**: 完善的数据保护机制

这个架构图展示了项目的完整技术架构和最新功能特性，可以帮助你在面试时清晰地展示项目的技术深度和设计思路！ 