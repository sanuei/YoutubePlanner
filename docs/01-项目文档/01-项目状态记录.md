# YouTube Planner é¡¹ç›®çŠ¶æ€è®°å½•

## ğŸ“… æœ€åæ›´æ–°æ—¶é—´
2024å¹´12æœˆ19æ—¥ - 18:30 (æœ€æ–°çŠ¶æ€)

## ğŸ¯ é¡¹ç›®æ¦‚è¿°
YouTubeè§†é¢‘è„šæœ¬ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…å«å‰ç«¯(React)å’Œåç«¯(Spring Boot)ï¼Œéƒ¨ç½²åœ¨AWS EC2ä¸Šã€‚

## ğŸŒ å½“å‰éƒ¨ç½²çŠ¶æ€

### åŸŸåå’ŒSSL
- **åŸŸå**: youtubeplanner.duckdns.org
- **DuckDNS Token**: 2a6b1938-8078-4553-a435-af0b72dfd3c6
- **SSLè¯ä¹¦**: Let's Encrypt
- **è¯ä¹¦æœ‰æ•ˆæœŸ**: 89å¤©
- **è‡ªåŠ¨ç»­æœŸ**: å·²é…ç½®ï¼ˆæ¯å¤©ä¸­åˆ12ç‚¹æ£€æŸ¥ï¼‰

### æœåŠ¡å™¨ä¿¡æ¯
- **äº‘æœåŠ¡å•†**: AWS EC2
- **å®ä¾‹ç±»å‹**: t2.micro (å…è´¹å¥—é¤)
- **å…¬ç½‘IP**: 43.206.130.75
- **åŒºåŸŸ**: ap-northeast-1 (ä¸œäº¬)
- **æ“ä½œç³»ç»Ÿ**: Amazon Linux 2

### åº”ç”¨æ¶æ„
```
ç”¨æˆ· â†’ HTTPS (443) â†’ Nginx â†’ 
â”œâ”€â”€ å‰ç«¯å®¹å™¨ (3000:80) - æš´éœ²ç«¯å£3000
â””â”€â”€ åç«¯å®¹å™¨ (8080:8080) - æš´éœ²ç«¯å£8080 â†’ PostgreSQLå®¹å™¨
```

## ğŸ³ Dockerå®¹å™¨çŠ¶æ€

### å½“å‰è¿è¡Œçš„å®¹å™¨
1. **youtubeplanner-db-prod**: PostgreSQL 15æ•°æ®åº“
2. **youtubeplanner-backend-prod**: Spring Bootåº”ç”¨
3. **youtubeplanner-frontend-prod**: Reactåº”ç”¨

### å®¹å™¨é…ç½®
- **ç½‘ç»œ**: youtubeplanner-network (bridge)
- **æ•°æ®æŒä¹…åŒ–**: postgres_data volume
- **æ—¥å¿—**: backend_logs volume

## ğŸ”§ æœ€æ–°é…ç½®æ›´æ–° (2024-12-19)

### ç¯å¢ƒå˜é‡é…ç½®
```yaml
# å‰ç«¯é…ç½®
REACT_APP_API_BASE_URL=https://youtubeplanner.duckdns.org/api/v1

# åç«¯é…ç½®
CORS_ALLOWED_ORIGINS=https://youtubeplanner.duckdns.org
```

### å®‰å…¨æ”¹è¿›
- âœ… é‡æ–°æš´éœ²å®¹å™¨ç«¯å£ä»¥æ”¯æŒNginxåå‘ä»£ç†
- âœ… æ‰€æœ‰æµé‡é€šè¿‡Nginxåå‘ä»£ç†
- âœ… å¯ç”¨HTTPSåŠ å¯†
- âœ… é™åˆ¶CORSåªå…è®¸æŒ‡å®šåŸŸå
- âœ… ä¿®å¤502 Bad Gatewayé”™è¯¯

## ğŸ“Š æ•°æ®åº“é…ç½®

### PostgreSQLè®¾ç½®
- **ç‰ˆæœ¬**: PostgreSQL 15 Alpine
- **æ•°æ®åº“å**: youtubeplanner
- **ç”¨æˆ·å**: youtubeplanner
- **å¯†ç **: youtubeplanner123
- **åˆå§‹åŒ–è„šæœ¬**: init-db.sql

### æ•°æ®è¡¨ç»“æ„
- users: ç”¨æˆ·è¡¨
- channels: é¢‘é“è¡¨
- categories: åˆ†ç±»è¡¨
- scripts: è„šæœ¬è¡¨
- chapters: ç« èŠ‚è¡¨

## ğŸš€ éƒ¨ç½²æµç¨‹

### CI/CDé…ç½®
- **å¹³å°**: GitHub Actions
- **è§¦å‘åˆ†æ”¯**: main, master, clean-deploy
- **éƒ¨ç½²æ–¹å¼**: Dockerå®¹å™¨åŒ–éƒ¨ç½²
- **è‡ªåŠ¨åŒ–ç¨‹åº¦**: å®Œå…¨è‡ªåŠ¨åŒ–

### éƒ¨ç½²æ­¥éª¤
1. ä»£ç æ¨é€åˆ°mainæˆ–clean-deployåˆ†æ”¯
2. GitHub Actionsè‡ªåŠ¨æ„å»ºDockeré•œåƒ
3. éƒ¨ç½²åˆ°EC2æœåŠ¡å™¨
4. å¥åº·æ£€æŸ¥ç¡®è®¤æœåŠ¡çŠ¶æ€

## ğŸ” å®‰å…¨é…ç½®

### JWTé…ç½®
- **Secret**: 404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970
- **Access Tokenè¿‡æœŸæ—¶é—´**: 3600ç§’ (1å°æ—¶)
- **Refresh Tokenè¿‡æœŸæ—¶é—´**: 604800ç§’ (7å¤©)

### Nginxé…ç½®
- **HTTPè‡ªåŠ¨é‡å®šå‘åˆ°HTTPS**
- **åå‘ä»£ç†é…ç½®**:
  - `/` â†’ å‰ç«¯å®¹å™¨:80
  - `/api/` â†’ åç«¯å®¹å™¨:8080
- **SSLè¯ä¹¦è·¯å¾„**: /etc/letsencrypt/live/youtubeplanner.duckdns.org/

## ğŸ“ å¾…åŠäº‹é¡¹

### å·²å®Œæˆ âœ…
- [x] ç¡®è®¤æ–°é…ç½®éƒ¨ç½²çŠ¶æ€
- [x] æµ‹è¯•HTTPSåŸŸåè®¿é—®
- [x] éªŒè¯APIè°ƒç”¨æ­£å¸¸
- [x] ä¿®å¤502 Bad Gatewayé”™è¯¯
- [x] åˆå¹¶åˆ†æ”¯åˆ°main
- [x] é‡æ–°æš´éœ²å®¹å™¨ç«¯å£

### æœªæ¥ä¼˜åŒ–
- [ ] æ·»åŠ ç›‘æ§å’Œæ—¥å¿—åˆ†æ
- [ ] æ•°æ®åº“å¤‡ä»½ç­–ç•¥
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] é”™è¯¯å¤„ç†æ”¹è¿›

## ğŸ› å·²çŸ¥é—®é¢˜
ç›®å‰æ— å·²çŸ¥é—®é¢˜ã€‚

## âœ… æœ€è¿‘è§£å†³çš„é—®é¢˜
- **502 Bad Gatewayé”™è¯¯** (2024-12-19): é€šè¿‡é‡æ–°æš´éœ²å®¹å™¨ç«¯å£è§£å†³
- **åˆ†æ”¯ç®¡ç†æ··ä¹±** (2024-12-19): å·²å°†clean-deployåˆ†æ”¯åˆå¹¶åˆ°main
- **æ–‡æ¡£ç»“æ„æ··ä¹±** (2024-12-19): å·²é‡æ–°æ•´ç†æ–‡æ¡£ç»“æ„

## ğŸ“ è”ç³»ä¿¡æ¯
- **GitHub**: https://github.com/sanuei/YoutubePlanner
- **ä¸»è¦åˆ†æ”¯**: main (ç”Ÿäº§ç¯å¢ƒ)
- **å¼€å‘åˆ†æ”¯**: clean-deploy

## ğŸ“š ç›¸å…³æ–‡æ¡£
- AWS-EC2-éƒ¨ç½²æŒ‡å—.md
- setup-domain.md
- api_doc_revised.md
- å…è´¹å¥—é¤éƒ¨ç½²æŒ‡å—.md 