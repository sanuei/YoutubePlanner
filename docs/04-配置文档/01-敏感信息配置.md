# 敏感信息配置文档

⚠️ **警告：此文件包含敏感信息，请勿上传到公共仓库**

## 🔐 JWT配置

### JWT密钥
```
JWT_SECRET=404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970
JWT_ACCESS_TOKEN_EXPIRATION=3600
JWT_REFRESH_TOKEN_EXPIRATION=604800
```

## 🗄️ 数据库配置

### 生产环境 - PostgreSQL (本地容器)
```
SPRING_DATASOURCE_URL=jdbc:postgresql://database:5432/youtubeplanner
SPRING_DATASOURCE_USERNAME=youtubeplanner
SPRING_DATASOURCE_PASSWORD=youtubeplanner123
```

### 历史配置 - Supabase (已弃用)
```
SPRING_DATASOURCE_URL=jdbc:postgresql://db.nvcagxykymgtmprggwhy.supabase.co:5432/postgres
SPRING_DATASOURCE_USERNAME=postgres
SPRING_DATASOURCE_PASSWORD=OtvO9P8X36b3up5x
```

## 🌐 域名和SSL配置

### DuckDNS配置
```
域名: youtubeplanner.duckdns.org
Token: 2a6b1938-8078-4553-a435-af0b72dfd3c6
```

### SSL证书路径
```
SSL_CERT_PATH=/etc/letsencrypt/live/youtubeplanner.duckdns.org/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/youtubeplanner.duckdns.org/privkey.pem
```

## ☁️ AWS配置

### EC2实例信息
```
公网IP: 35.77.213.182
区域: ap-northeast-1 (东京)
实例类型: t2.micro
操作系统: Amazon Linux 2
```

### SSH连接
```
SSH命令: ssh -i ".././test.pem" ec2-user@ec2-35-77-213-182.ap-northeast-1.compute.amazonaws.com
密钥文件: .././test.pem
用户名: ec2-user
```

## 🔧 GitHub Actions Secrets

### 必需的Secrets
```
EC2_HOST=35.77.213.182
EC2_USER=ec2-user
EC2_SSH_KEY=<SSH私钥内容>
```

### 部署分支配置
```
触发分支: main, master, clean-deploy
主要分支: main (生产环境)
开发分支: clean-deploy
```

## 🌍 环境变量配置

### 前端环境变量
```
REACT_APP_API_BASE_URL=https://youtubeplanner.duckdns.org/api/v1
```

### 后端环境变量
```
SPRING_PROFILES_ACTIVE=prod
CORS_ALLOWED_ORIGINS=https://youtubeplanner.duckdns.org
```

## 📧 邮件配置 (可选)
```
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
```

## 🔄 DuckDNS自动更新脚本
```bash
# 更新脚本内容
echo url="https://www.duckdns.org/update?domains=youtubeplanner&token=2a6b1938-8078-4553-a435-af0b72dfd3c6&ip=" | curl -k -o ~/duckdns/duck.log -K -

# Cron任务
*/5 * * * * ~/duckdns/duck.sh >/dev/null 2>&1
```

## 🛡️ 安全注意事项

1. **定期更换密码**：建议每3-6个月更换数据库密码
2. **JWT密钥轮换**：生产环境应定期更换JWT密钥
3. **SSL证书续期**：Let's Encrypt证书每90天自动续期
4. **访问控制**：限制SSH访问IP范围
5. **备份加密**：所有备份文件应加密存储
6. **容器端口管理**：生产环境已暴露3000和8080端口用于Nginx反向代理

## 📝 密码强度要求

- **数据库密码**：至少12位，包含大小写字母、数字、特殊字符
- **JWT密钥**：256位随机字符串
- **用户密码**：至少8位，包含大小写字母、数字、特殊字符

---

**创建时间**: 2024年12月19日  
**最后更新**: 2024年12月19日 - 18:30  
**状态**: 🔒 机密文档

## 🔄 最新更新记录

### 2024-12-19 18:30
- ✅ 修复502错误：重新暴露容器端口
- ✅ 前端容器端口：3000:80
- ✅ 后端容器端口：8080:8080
- ✅ 分支合并：clean-deploy → main 